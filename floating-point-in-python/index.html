<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.45 'georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'georgia',serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}ul{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:0.85rem;line-height:1.45rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}blockquote{margin-left:1.45rem;margin-right:1.45rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.45rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.45rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}li > ul{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.45rem / 2);}code{font-size:0.85rem;line-height:1.45rem;}kbd{font-size:0.85rem;line-height:1.45rem;}samp{font-size:0.85rem;line-height:1.45rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:0.96667rem;padding-right:0.96667rem;padding-top:0.725rem;padding-bottom:calc(0.725rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}</style><meta name="generator" content="Gatsby 5.13.3"/><meta data-react-helmet="true" name="description" content="실수형 값을 다룰 때 흔히 마주칠 수 있는 부동소수점 오차 문제를 파이썬에서 어떻게 해결할 수 있는지 알아보았다. 이 글은 2017년에 작성했던 글을 다듬고 내용을 추가해 다시 작성한 글입니다. 본래 글은 이 문서로 리다이렉트됩니다. 부동소수점의 문…"/><meta data-react-helmet="true" name="image" content="https://www.winterjung.dev/header.png"/><meta data-react-helmet="true" property="og:title" content="파이썬에서 부동소수점 오차 해결하기"/><meta data-react-helmet="true" property="og:url" content="https://www.winterjung.dev/floating-point-in-python/"/><meta data-react-helmet="true" property="og:description" content="실수형 값을 다룰 때 흔히 마주칠 수 있는 부동소수점 오차 문제를 파이썬에서 어떻게 해결할 수 있는지 알아보았다. 이 글은 2017년에 작성했던 글을 다듬고 내용을 추가해 다시 작성한 글입니다. 본래 글은 이 문서로 리다이렉트됩니다. 부동소수점의 문…"/><meta data-react-helmet="true" property="og:image" content="https://www.winterjung.dev/header.png"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="파이썬에서 부동소수점 오차 해결하기"/><meta data-react-helmet="true" name="twitter:description" content="실수형 값을 다룰 때 흔히 마주칠 수 있는 부동소수점 오차 문제를 파이썬에서 어떻게 해결할 수 있는지 알아보았다. 이 글은 2017년에 작성했던 글을 다듬고 내용을 추가해 다시 작성한 글입니다. 본래 글은 이 문서로 리다이렉트됩니다. 부동소수점의 문…"/><meta data-react-helmet="true" name="twitter:image" content="https://www.winterjung.dev/header.png"/><meta data-react-helmet="true" name="twitter:creator" content="@res_tin"/><style data-href="/styles.763531abacb6bc2bb1d5.css" data-identity="gatsby-global-css">code,pre{font-family:Fira Code,SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace}pre{background-color:#f6f8fa;line-height:1.45;overflow:auto;padding:16px}code,pre{border-radius:3px}code{background-color:rgba(27,31,35,.05);font-size:.85em;margin:0;padding:.2em .4em}pre>code{background:transparent;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}</style><title data-react-helmet="true">파이썬에서 부동소수점 오차 해결하기</title><link data-react-helmet="true" rel="canonical" href="https://www.winterjung.dev/floating-point-in-python/"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css 1uuzzhj">.css-1uuzzhj{margin:0 auto;max-width:700px;padding:2.9rem;padding-top:2.175rem;}</style><div class="css-1uuzzhj"><a href="/"><style data-emotion="css jfvr3k">.css-jfvr3k{margin-bottom:1.45rem;display:inline-block;font-style:normal;}</style><h2 class="css-jfvr3k">winterjung blog</h2><hr/></a><div><h1>파이썬에서 부동소수점 오차 해결하기</h1><style data-emotion="css 255c6r">.css-255c6r{word-break:keep-all;}</style><div class="css-255c6r"><p>실수형 값을 다룰 때 흔히 마주칠 수 있는 부동소수점 오차 문제를 파이썬에서 어떻게 해결할 수 있는지 알아보았다.</p>
<blockquote>
<p>이 글은 <a href="https://github.com/JungWinter/JungWinter.github.io/blob/496e1b8e4563cd32c291cde1f1db62684d6db7dd/_posts/2017-1-12-Floating-Point.md">2017년에 작성했던 글</a>을 다듬고 내용을 추가해 다시 작성한 글입니다. 본래 글은 이 문서로 리다이렉트됩니다.</p>
</blockquote>
<h2>부동소수점의 문제</h2>
<p><code>float</code> 자료형을 쓸 때는 항상 주의해야 한다. 특히 <code>if</code> 문으로 값을 확인할 때 이를 간과하면 아래처럼 찾기 힘든 버그가 발생한다.</p>
<pre><code class="language-python">>>> 0.1 * 3 == 0.3
False
>>> 1.2 - 0.1 == 1.1
False
>>> 0.1 * 0.1 == 0.01
False
</code></pre>
<p>그동안 위와 같은 일이 발생해도 그저 '부동소수점 때문에 그래' 정도로만 알고 있었는데 그 이유를 좀 더 자세히 알아보고 파이썬에서 어떻게 해결할 수 있는지 알아보았다.</p>
<blockquote>
<p><code>부동소수점</code>에 대한 설명은 다른 자료들에서 잘 다루고 있으니 여기선 <a href="https://ko.wikipedia.org/wiki/%EB%B6%80%EB%8F%99%EC%86%8C%EC%88%98%EC%A0%90">위키피디아 문서</a>로 대체한다.</p>
</blockquote>
<h2>부동소수점의 표현 방식</h2>
<p>컴퓨터에서 부동소수점 숫자들은 2진 분수로 표현되기에 꽤 많은 값은 정확히 표현될 수 없다. 그렇기에 사람이 이해하기 쉽게 입력하는 10진 부동소수점 숫자는 2진 부동소수점 숫자로 근사 된다. 예를 들어 10진수 0.1은 2진 분수로 정확하게 표현될 수 없고 <code>0.0001100110011001100110...</code>처럼 무한히 반복되기에 특정 비트에서 멈추고 근사값을 얻는다. 0.1의 경우는 <code>3602879701896397 / 2 ** 55</code>이며 0.1에 가깝지만, 정확히 동일하지는 않다.</p>
<pre><code class="language-python">>>> decimal.Decimal(3602879701896397 / 2 ** 55)
Decimal('0.1000000000000000055511151231257827021181583404541015625')
>>> decimal.Decimal(0.1)
Decimal('0.1000000000000000055511151231257827021181583404541015625')
</code></pre>
<p>다만 이를 곧이곧대로 길게 표현한다면 꽤 많은 상황에서 성가실 것이기에 파이썬에선 이런 부동소수점 값을 표현할 때 정확히 표현하지 않고 10진수 근삿값만을 표시한다.</p>
<pre><code class="language-python">>>> 0.1
0.1000000000000000055511151231257827021181583404541015625
</code></pre>
<p>0.1에 대해 실제 십진수 값을 출력한다면 위와 같겠지만 파이썬에선 반올림된 값을 표시한다.</p>
<pre><code class="language-python">>>> 1 / 10
0.1
</code></pre>
<p>이런 부동소수점의 한계는 파이썬뿐만 아니라 부동소수점을 지원하는 거의 모든 언어에서 찾아볼 수 있다.</p>
<blockquote>
<p>각 언어의 부동소수점 처리 방식을 볼 수 있는 <a href="https://0.30000000000000004.com/">0.30000000000000004.com</a>이란 사이트도 있다.</p>
</blockquote>
<h2>해결책</h2>
<p><code>decimal.Decimal</code>, <code>math.fsum()</code>, <code>round()</code>, <code>float.as_integer_ratio()</code>, <code>math.is_close()</code> 함수 혹은 다른 방법을 통해서 실수를 방지할 수 있다. 이 중 가장 추천하는 방법은 <code>decimal</code> 표준 라이브러리를 사용한 방법이고 그 외에도 존재하는 관련 함수들을 소개한다.</p>
<h3><code>decimal.Decimal</code></h3>
<pre><code class="language-py">>>> import decimal
>>> decimal.Decimal('0.1') * 3 == decimal.Decimal('0.3')
True
>>> decimal.Decimal('0.3') + 2
Decimal('2.3')
</code></pre>
<p><a href="https://docs.python.org/3/library/decimal.html"><code>decimal</code> 모듈</a>을 사용하면 위 문제를 가장 깔끔하게 해결할 수 있다. 파이썬 문서에서도 언급하듯 빠르고 정확한 부동 소수 산술을 지원하며 <code>float</code> 자료형을 그대로 사용할 때 보다 여러 이점이 있다고 말한다.</p>
<p>다만 아래와 같이 사용한다면 여전히 문제가 발생하고 이를 처리하는 건 <code>decimal</code> 모듈의 책임이 아니기에 사용에 주의해야 한다.</p>
<pre><code class="language-py">>>> decimal.Decimal(0.1 * 3)
Decimal('0.3000000000000000444089209850062616169452667236328125')
</code></pre>
<h3><code>math.fsum()</code></h3>
<p><a href="https://docs.python.org/3/library/math.html#math.fsum"><code>math</code> 모듈의 <code>fsum()</code> 함수</a>를 이용해 두 개 이상의 부동소수점 합계와 관련된 반올림 오류 누적을 제거하여 정밀도 손실을 방지할 수 있다.</p>
<pre><code class="language-python">>>> sum([.1] * 10)
0.9999999999999999
>>> math.fsum([.1] * 10)
1.0
</code></pre>
<p>다만 <code>fsum()</code>은 중간중간 누적된 오류를 해결하기 위함이지 정확한 부동소수점 연산을 위한 게 아니다 보니 유명한 <code>0.1 + 0.2</code>처럼 항상 원하는 결과를 기대할 수는 없다.</p>
<pre><code class="language-python">>>> math.fsum([.1, .2])
0.30000000000000004
</code></pre>
<ul>
<li><a href="http://stackoverflow.com/questions/34650535/python2-math-fsum-not-accurate">스택오버플로우 : 왜 fsum은 부정확한가 </a></li>
</ul>
<h3><code>round()</code></h3>
<p>빌트인 함수로 있는 <code>round()</code>로 반올림해 해결하는 방법도 있다.</p>
<pre><code class="language-python">>>> round(0.1 + 0.1 + 0.1, 10) == round(0.3, 10)
True
>>> 0.1 + 0.1 + 0.1 == 0.3
False
# 0.1 + 0.1 + 0.1은 0.3과 다르다.
>>> decimal.Decimal(0.1 + 0.1 + 0.1)
Decimal('0.3000000000000000444089209850062616169452667236328125')
>>> decimal.Decimal(0.3)
Decimal('0.299999999999999988897769753748434595763683319091796875')
</code></pre>
<p>당연하게도 사전 <code>round()</code>는 도움이 되지 않는데 <code>0.1</code>은 <code>round(0.1, 1)</code> 등과 같기에 각각을 반올림하고 더해주는건 아무 의미 없다.</p>
<pre><code class="language-python">>>> round(0.1, 1) + round(0.1, 1) + round(0.1, 1) == round(0.3, 1)
False
</code></pre>
<h4>반올림 모드</h4>
<p>우리는 반올림을 할 때 5부터는 올림으로 그 밑은 내림으로 한다고 알고 있지만 파이썬에선 여러 가지 반올림 모드 옵션을 제공한다. 기본적으로 설정된 모드 상으론 값에 따라 어떤건 0.5더라도 내림이 되기도 하고 올림이 되기도 한다.</p>
<pre><code class="language-python">>>> round(0.125, 2)
0.12
>>> round(0.135, 2)
0.14
</code></pre>
<p>이 반올림 모드엔 여러 가지가 있는데 <a href="https://docs.python.org/ko/3/library/decimal.html#decimal.DefaultContext">기본적으로 <code>ROUND_HALF_EVEN</code>이라는 모드로 지정</a>되어 있고 이는 짝수랑 가까워지는 방향으로 동작한다. 현재 적용된 반올림 방식이 무엇인지는 <code>deciaml.getcontext()</code>로 확인해 볼 수 있다.</p>
<pre><code class="language-python">>>> import decimal
>>> decimal.getcontext()
Context(prec=28, rounding=ROUND_HALF_EVEN, Emin=-999999, Emax=999999, ...)
</code></pre>
<ul>
<li><code>ROUND_CEILING</code></li>
<li><code>ROUND_DOWN</code></li>
<li><code>ROUND_FLOOR</code></li>
<li><code>ROUND_HALF_DOWN</code></li>
<li><code>ROUND_HALF_UP</code></li>
<li><code>ROUND_UP</code></li>
<li><code>ROUND_05UP</code></li>
</ul>
<p>위와 같이 <a href="https://docs.python.org/3/library/decimal.html#rounding-modes">8가지 방식</a>이 존재하며 런타임에 이를 아래처럼 변경할 수 있다.</p>
<pre><code class="language-python">>>> ctx = decimal.getcontext()
>>> ctx.rounding = decimal.ROUND_UP  # 혹은 'ROUND_UP' 문자열도 사용 가능
</code></pre>
<h3><code>float.as_integer_ratio()</code></h3>
<p>파이썬 <code>float</code> 자료형에는 <code>as_integer_ratio()</code> 함수가 내장되어 있다.</p>
<pre><code class="language-python">>>> x = 3.141592
>>> x.as_integer_ratio()
(3537118140137533, 1125899906842624)
>>> x == 3537118140137533 / 1125899906842624
True
</code></pre>
<p>연산의 오차 보정용이라기 보다는 원래 값을 손실 없이 다시 만드는 데 유용하다.</p>
<h3><code>math.is_close()</code></h3>
<p>파이썬 3.5에서 새로 추가된 <code>math</code> 모듈의 함수다. <code>isclose(a, b, rel_tol=1e-9, abs_tol=0.0)</code>같은 형태이며 <code>a</code>와 <code>b</code>는 비교할 값들, <code>rel_tol</code>은 relative tolerance, <code>abs_tol</code>은 absolute tolerance다. <code>decimal</code>을 사용할 만큼 엄격한 상황이 아니라면 위에 나온 방법들보다 제일 간단하고 직관적이다.</p>
<p>다만 파이썬 3.5 이상부터 내장되어 있으며 그보다 하위 버전에서는 직접 <code>is_close()</code> 함수를 만들어 사용해야 한다.</p>
<pre><code class="language-python"># 간단한 버전
def is_close(a, b, rel_tol=1e-09, abs_tol=0.0):
    return abs(a-b) &#x3C;= max(rel_tol * max(abs(a), abs(b)), abs_tol)
</code></pre>
<ul>
<li><a href="https://docs.python.org/3/library/math.html#math.isclose"><code>math.is_close</code> 문서</a></li>
<li><a href="https://www.python.org/dev/peps/pep-0485/">PEP 485 - A Function for testing approximate equality</a></li>
<li><a href="https://github.com/PythonCHB/close_pep/blob/master/is_close.py"><code>math.is_close()</code>의 원형</a></li>
</ul>
<h3>기타</h3>
<p>가장 쉽고 널리 사용되는 방법으로는 아마 <code>abs(a - b) &#x3C;= 1e-9</code> 정도가 아닐까 싶다.</p>
<h2>정리</h2>
<p><code>float</code> 자료형을 다룰 땐 항상 부동소수점 오차를 의식해야 한다. 위에서 나온 해결책 말고도 다양한 해결책이 있을 수 있겠지만 일단 회계나 금융의 엄격함이 요구된다면 <code>decimal</code> 모듈을 그렇지 않다면 마지막의 짧은 snippet이나 <code>math.is_close()</code>, <code>round()</code> 정도만 사용해도 크게 문제는 없으리라 생각한다.</p>
<h2>참고</h2>
<ul>
<li><a href="https://docs.python.org/3/tutorial/floatingpoint.html">python3 document - Floating Point Arithmetic: Issues and Limitations</a></li>
<li><a href="https://app.box.com/s/vlij64akloz25k0fmk24o1fqxdndg8ie">모든 컴퓨터 과학자가 알아야 할 부동 소수점의 모든것</a></li>
<li><a href="http://stackoverflow.com/questions/5595425/what-is-the-best-way-to-compare-floats-for-almost-equality-in-python">stackoverflow - What is the best way to compare floats for almost-equality in Python?</a></li>
<li><a href="https://blog.udemy.com/python-round">udemy blog - Python Round: Problems and Solutions</a></li>
</ul></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-GHDZ9WX1EH"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-GHDZ9WX1EH', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/floating-point-in-python/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-2de8dd80665bcb02167b.js\"],\"component---src-pages-404-jsx\":[\"/component---src-pages-404-jsx-2e46b0aedfddc9ed0d72.js\"],\"component---src-pages-index-jsx\":[\"/component---src-pages-index-jsx-a3f57e32931f87b809ea.js\"],\"component---src-pages-my-files-jsx\":[\"/component---src-pages-my-files-jsx-e3918b5adbccab2e288d.js\"],\"component---src-templates-post-jsx\":[\"/component---src-templates-post-jsx-8e21b8079b44f8d9ec12.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="f2cff95366a5da3cb373";</script><script src="/webpack-runtime-ef87f0342182738b6f71.js" async></script><script src="/framework-1f1ec840701ba3409b52.js" async></script><script src="/app-2de8dd80665bcb02167b.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>